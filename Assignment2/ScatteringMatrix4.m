function S = ScatteringMatrix4(omega,omegaR,vR,gamma,a,c)

D1 = ScatteringMatrix31(omega,omegaR,vR,gamma,a,c);
D2 = ScatteringMatrix31(omega,omegaR,vR,gamma,a,c);

S  = zeros(4,4);

S(1,1) = D1(1,1)+D1(1,3)*D1(3,1)*D2(1,1)/(1-D1(3,3)*D2(1,1));
S(1,2) = D1(1,2)+D1(1,3)*D1(3,2)*D2(1,1)/(1-D1(3,3)*D2(1,1));
S(1,3) = D1(1,3)*D2(1,2)/(1-D1(3,3)*D2(1,1));
S(1,4) = D1(1,3)*D2(1,3)/(1-D1(3,3)*D2(1,1));
S(2,1) = D1(2,1)+D1(2,3)*D1(3,1)*D2(1,1)/(1-D1(3,3)*D2(1,1));
S(2,2) = D1(2,2)+D1(2,3)*D1(3,2)*D2(1,1)/(1-D1(3,3)*D2(1,1));
S(2,3) = D1(2,3)*D2(1,2)/(1-D1(3,3)*D2(1,1));
S(2,4) = D1(2,3)*D2(1,3)/(1-D1(3,3)*D2(1,1));
S(3,1) = D2(2,1)*D1(3,1)/(1-D1(3,3)*D2(1,1));
S(3,2) = D2(2,1)*D1(3,2)/(1-D1(3,3)*D2(1,1));
S(3,3) = D2(2,2)+D2(2,1)*D2(1,2)*D1(3,3)/(1-D1(3,3)*D2(1,1));
S(3,4) = D2(2,3)+D2(2,1)*D2(1,3)*D1(3,3)/(1-D1(3,3)*D2(1,1));
S(4,1) = D2(3,1)*D1(3,1)/(1-D1(3,3)*D2(1,1));
S(4,2) = D2(3,1)*D1(3,2)/(1-D1(3,3)*D2(1,1));
S(4,3) = D2(3,2)+D2(3,1)*D2(1,2)*D1(3,3)/(1-D1(3,3)*D2(1,1));
S(4,4) = D2(3,3)+D2(1,3)*D2(3,1)*D1(3,3)/(1-D1(3,3)*D2(1,1));

end